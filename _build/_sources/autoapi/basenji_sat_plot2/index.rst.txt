:py:mod:`basenji_sat_plot2`
===========================

.. py:module:: basenji_sat_plot2


Module Contents
---------------


Functions
~~~~~~~~~

.. autoapisummary::

   basenji_sat_plot2.main
   basenji_sat_plot2.expand_4l
   basenji_sat_plot2.expand_scores_align
   basenji_sat_plot2.global_align
   basenji_sat_plot2.plot_seqlogo
   basenji_sat_plot2.setup_plot
   basenji_sat_plot2.subplot_params



.. py:function:: main()


.. py:function:: expand_4l(sat_lg_ti, seq_align)

   Expand a sat mut score array to another dimension
      representing nucleotides.

   In:
       sat_lg_ti (l array): Sat mut loss/gain scores for a single
                            sequence and target.
       seq_align (l array): Sequence nucleotides, with gaps.

   Out:
       sat_loss_4l (lx4 array): Score-hot coding?



.. py:function:: expand_scores_align(scores1, scores2, seq1_1hot, seq2_1hot, seq1_align, seq2_align)

   Expand two scores arrays according to a sequence alignment with NaNs in gaps.


.. py:function:: global_align(seq1_1hot, seq2_1hot)

   Align two 1-hot encoded sequences.


.. py:function:: plot_seqlogo(ax, seq_align, sat_score_ti, pseudo_pct=0.05)

   Plot a sequence logo for the loss/gain scores.

   Args:
       ax (Axis): matplotlib axis to plot to.
       seq_align (L array): Sequence nucleotides, with gaps.
       sat_score_ti (L_sm array): Minimum mutation delta across satmut length.
       pseudo_pct (float): % of the max to add as a pseudocount.


.. py:function:: setup_plot(figure_width, plot_len)


.. py:function:: subplot_params(seq_len)

   Specify subplot layout parameters for various sequence lengths. 


