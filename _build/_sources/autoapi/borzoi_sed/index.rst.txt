:py:mod:`borzoi_sed`
====================

.. py:module:: borzoi_sed


Module Contents
---------------


Functions
~~~~~~~~~

.. autoapisummary::

   borzoi_sed.main
   borzoi_sed.map_snpseq_genes
   borzoi_sed.initialize_output_h5
   borzoi_sed.make_snpseq_bedt
   borzoi_sed.targets_prep_strand
   borzoi_sed.write_pct
   borzoi_sed.write_bedgraph_snp
   borzoi_sed.write_snp



.. py:function:: main()


.. py:function:: map_snpseq_genes(snps, seq_len, transcriptome, model_stride, span, majority_overlap=True, intron1=False)

   Intersect SNP sequences with gene exons, constructing a list
   mapping sequence indexes to dictionaries of gene_ids to their
   exon-overlapping positions in the sequence.


.. py:function:: initialize_output_h5(out_dir, sed_stats, snps, snpseq_gene_slice, targets_df)

   Initialize an output HDF5 file for SAD stats.


.. py:function:: make_snpseq_bedt(snps, seq_len)

   Make a BedTool object for all SNP sequences.


.. py:function:: targets_prep_strand(targets_df)


.. py:function:: write_pct(sed_out, sed_stats)

   Compute percentile values for each target and write to HDF5.


.. py:function:: write_bedgraph_snp(snp, ref_preds, alt_preds, out_dir, model_stride)

   Write full predictions around SNP as BedGraph.


.. py:function:: write_snp(ref_preds, alt_preds, sed_out, xi, sed_stats, pseudocounts)

   Write SNP predictions to HDF, assuming the length dimension has
   been maintained.


