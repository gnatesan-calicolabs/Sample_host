:py:mod:`basenji_data`
======================

.. py:module:: basenji_data


Module Contents
---------------


Functions
~~~~~~~~~

.. autoapisummary::

   basenji_data.main
   basenji_data.annotate_unmap
   basenji_data.break_large_contigs
   basenji_data.contig_sequences
   basenji_data.curate_peaks
   basenji_data.divide_contigs_chr
   basenji_data.divide_contigs_folds
   basenji_data.divide_contigs_pct
   basenji_data.limit_contigs
   basenji_data.rejoin_large_contigs
   basenji_data.write_seqs_bed



Attributes
~~~~~~~~~~

.. autoapisummary::

   basenji_data.Contig
   basenji_data.ModelSeq


.. py:function:: main()


.. py:function:: annotate_unmap(mseqs, unmap_bed, seq_length, pool_width)

   Intersect the sequence segments with unmappable regions
        and annoate the segments as NaN to possible be ignored.

   Args:
     mseqs: list of ModelSeq's
     unmap_bed: unmappable regions BED file
     seq_length: sequence length (after cropping)
     pool_width: pooled bin width

   Returns:
     seqs_unmap: NxL binary NA indicators


.. py:function:: break_large_contigs(contigs, break_t, verbose=False)

   Break large contigs in half until all contigs are under
   the size threshold.


.. py:function:: contig_sequences(contigs, seq_length, stride, snap=1, label=None)

   Break up a list of Contig's into a list of ModelSeq's. 


.. py:function:: curate_peaks(targets_df, out_dir, pool_width, crop_bp)

   Merge all peaks, round to nearest pool_width, and add cropped bp.


.. py:function:: divide_contigs_chr(contigs, test_chrs, valid_chrs)

   Divide list of contigs into train/valid/test lists
   by chromosome.


.. py:function:: divide_contigs_folds(contigs, folds)

   Divide list of contigs into cross fold lists.


.. py:function:: divide_contigs_pct(contigs, test_pct, valid_pct, pct_abstain=0.2)

   Divide list of contigs into train/valid/test lists,
   aiming for the specified nucleotide percentages.


.. py:function:: limit_contigs(contigs, filter_bed)

   Limit to contigs overlapping the given BED.

   Args
    contigs: list of Contigs
    filter_bed: BED file to filter by

   Returns:
    fcontigs: list of Contigs


.. py:function:: rejoin_large_contigs(contigs)

   Rejoin large contigs that were broken up before alignment comparison.


.. py:function:: write_seqs_bed(bed_file, seqs, labels=False)

   Write sequences to BED file.


.. py:data:: Contig

   

.. py:data:: ModelSeq

   

