:py:mod:`basenji_sat_h5`
========================

.. py:module:: basenji_sat_h5


Module Contents
---------------


Functions
~~~~~~~~~

.. autoapisummary::

   basenji_sat_h5.main
   basenji_sat_h5.enrich_activity
   basenji_sat_h5.expand_4l
   basenji_sat_h5.delta_matrix
   basenji_sat_h5.loss_gain
   basenji_sat_h5.parse_input
   basenji_sat_h5.plot_heat
   basenji_sat_h5.plot_predictions
   basenji_sat_h5.plot_sad
   basenji_sat_h5.plot_seqlogo
   basenji_sat_h5.satmut_seqs
   basenji_sat_h5.subplot_params



.. py:function:: main()


.. py:function:: enrich_activity(seqs, seqs_1hot, targets, activity_enrich, target_indexes)

   Filter data for the most active sequences in the set. 


.. py:function:: expand_4l(sat_lg_ti, seq_1hot)

   Expand

   In:
       sat_lg_ti (l array): Sat mut loss/gain scores for a single sequence and
       target.
       seq_1hot (Lx4 array): One-hot coding for a single sequence.

   Out:
       sat_loss_4l (lx4 array): Score-hot coding?



.. py:function:: delta_matrix(seqs_1hot, sat_preds, satmut_len)

   Compute the matrix of prediction deltas

   Args:
       seqs_1hot (Lx4 array): One-hot coding of all sequences.
       sat_preds: (SMxLxT array): Satmut sequence predictions.
       satmut_len: Saturated mutagenesis region length.

   Returns:
       sat_delta (4 x L_sm x T array): Delta matrix for saturated mutagenesis
       region.

   Todo:
       -Rather than computing the delta as the change at that nucleotide's
       prediction,
           compute it as the mean change across the sequence. That way, we
           better
           pick up on motif-flanking interactions.


.. py:function:: loss_gain(sat_delta, sat_preds_si, satmut_len)


.. py:function:: parse_input(input_file, sample)

   Parse an input file that might be FASTA or HDF5. 


.. py:function:: plot_heat(ax, sat_delta_ti, min_limit)

   Plot satmut deltas.

   Args:
       ax (Axis): matplotlib axis to plot to.
       sat_delta_ti (4 x L_sm array): Single target delta matrix for saturated mutagenesis region,
       min_limit (float): Minimum heatmap limit.


.. py:function:: plot_predictions(ax, preds, satmut_len, seq_len, buffer)

   Plot the raw predictions for a sequence and target
       across the specificed saturated mutagenesis region.

   Args:
       ax (Axis): matplotlib axis to plot to.
       preds (L array): Target predictions for one sequence.
       satmut_len (int): Satmut length from which to determine
                          the values to plot.
       seq_len (int): Full sequence length.
       buffer (int): Ignored buffer sequence on each side


.. py:function:: plot_sad(ax, sat_loss_ti, sat_gain_ti)

   Plot loss and gain SAD scores.

   Args:
       ax (Axis): matplotlib axis to plot to.
       sat_loss_ti (L_sm array): Minimum mutation delta across satmut length.
       sat_gain_ti (L_sm array): Maximum mutation delta across satmut length.


.. py:function:: plot_seqlogo(ax, seq_1hot, sat_score_ti, pseudo_pct=0.05)

   Plot a sequence logo for the loss/gain scores.

   Args:
       ax (Axis): matplotlib axis to plot to.
       seq_1hot (Lx4 array): One-hot coding of a sequence.
       sat_score_ti (L_sm array): Minimum mutation delta across satmut length.
       pseudo_pct (float): % of the max to add as a pseudocount.


.. py:function:: satmut_seqs(seqs_1hot, satmut_len)

   Construct a new array with the given sequences and saturated
   mutagenesis versions of them. 


.. py:function:: subplot_params(seq_len)

   Specify subplot layout parameters for various sequence lengths. 


